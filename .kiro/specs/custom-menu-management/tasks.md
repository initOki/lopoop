# 구현 계획: 커스텀 메뉴 관리

## 개요

커스텀 메뉴 관리 시스템을 기존 LOPOOP 애플리케이션에 통합하여 사용자가 다양한 타입의 메뉴를 동적으로 생성하고 관리할 수 있도록 구현합니다. TanStack Router 기반 아키텍처를 확장하고 Supabase 실시간 구독을 활용한 동적 네비게이션 시스템을 구축합니다.

## 작업 목록

- [x] 1. 데이터베이스 스키마 및 타입 설정
  - Supabase에 custom_menus 및 menu_members 테이블 생성
  - TypeScript 타입 정의 및 데이터베이스 타입 업데이트
  - RLS 정책 및 인덱스 설정
  - _요구사항: 1.5, 6.3, 8.1_

- [x] 1.1 메뉴 데이터 지속성 속성 테스트 작성
  - **속성 4: 메뉴 생성 시 데이터베이스 지속성**
  - **검증: 요구사항 1.5**

- [x] 2. 핵심 메뉴 관리 컴포넌트 구현
  - [x] 2.1 CustomMenu 인터페이스 및 MenuType enum 정의
    - 메뉴 데이터 구조와 타입 시스템 구현
    - _요구사항: 1.1, 1.2_

  - [x] 2.2 MenuManager 컴포넌트 구현
    - 메뉴 목록 표시 및 상태 관리
    - 실시간 구독을 통한 메뉴 동기화
    - _요구사항: 7.1, 8.4_

  - [x] 2.3 실시간 메뉴 동기화 속성 테스트 작성
    - **속성 26: 실시간 메뉴 변경사항 동기화**
    - **검증: 요구사항 8.4**

- [x] 3. 메뉴 생성 및 편집 기능 구현
  - [x] 3.1 MenuCreator 컴포넌트 구현
    - 메뉴 타입 선택 인터페이스
    - 메뉴 이름 입력 및 검증
    - _요구사항: 1.1, 1.2, 1.3_

  - [ ]* 3.2 메뉴 타입 선택 속성 테스트 작성
    - **속성 1: 메뉴 타입 선택 시 설정 옵션 표시**
    - **검증: 요구사항 1.2**

  - [ ]* 3.3 메뉴 이름 검증 속성 테스트 작성
    - **속성 2: 메뉴 이름 검증 및 고유성**
    - **검증: 요구사항 1.3, 3.3**

  - [x] 3.4 메뉴 편집 기능 구현
    - 기존 메뉴 설정 로드 및 편집
    - 메뉴 타입 변경 시 데이터 보존/경고
    - _요구사항: 5.1, 5.2, 5.4, 5.5_

  - [ ]* 3.5 메뉴 편집 속성 테스트 작성
    - **속성 12: 메뉴 설정 편집 인터페이스**
    - **속성 13: 메뉴 변경사항 검증 및 실시간 동기화**
    - **검증: 요구사항 5.1, 5.2, 5.3**

- [x] 4. 체크포인트 - 기본 메뉴 관리 기능 검증
  - 모든 테스트가 통과하는지 확인하고, 질문이 있으면 사용자에게 문의

- [x] 5. 동적 네비게이션 시스템 구현
  - [x] 5.1 DynamicNavigation 컴포넌트 구현
    - 기존 Header 컴포넌트 확장
    - 커스텀 메뉴 섹션 추가
    - _요구사항: 7.1, 7.2_

  - [x] 5.2 메뉴 순서 관리 및 재정렬 기능
    - 드래그 앤 드롭 인터페이스
    - 메뉴 순서 저장 및 동기화
    - _요구사항: 7.4_

  - [ ]* 5.3 네비게이션 업데이트 속성 테스트 작성
    - **속성 3: 메뉴 생성 시 네비게이션 자동 업데이트**
    - **속성 20: 커스텀 메뉴 전용 섹션 조직화**
    - **검증: 요구사항 1.4, 7.1, 7.2**

- [x] 6. 동적 라우팅 시스템 구현
  - [x] 6.1 MenuRouter 컴포넌트 구현
    - 커스텀 메뉴 경로 처리
    - 메뉴 타입별 컴포넌트 라우팅
    - _요구사항: 2.1, 2.2_

  - [x] 6.2 메뉴 타입별 페이지 자동 생성
    - MenuTypeFactory 패턴 구현
    - 각 메뉴 타입별 기본 컴포넌트 생성
    - _요구사항: 2.1, 2.3_

  - [ ]* 6.3 동적 라우팅 속성 테스트 작성
    - **속성 5: 메뉴 타입별 자동 페이지 생성**
    - **속성 6: 메뉴 클릭 시 올바른 라우팅**
    - **검증: 요구사항 2.1, 2.2**

- [x] 7. 메뉴 타입별 컴포넌트 구현
  - [x] 7.1 그룹 메뉴 컴포넌트 구현
    - 멤버 관리 인터페이스
    - 공지사항 및 그룹 스케줄링 기능
    - _요구사항: 4.1_

  - [x] 7.2 개인 대시보드 컴포넌트 구현
    - 커스터마이징 가능한 위젯 시스템
    - 개인 추적 도구 인터페이스
    - _요구사항: 4.2_

  - [x] 7.3 외부 링크 메뉴 컴포넌트 구현
    - 링크 관리 인터페이스
    - 빠른 접근 기능
    - _요구사항: 4.3_

  - [x] 7.4 커스텀 페이지 컴포넌트 구현
    - 유연한 콘텐츠 에디터
    - 템플릿 시스템
    - _요구사항: 4.4_

  - [ ]* 7.5 메뉴 타입별 기능 단위 테스트 작성
    - 각 메뉴 타입의 특정 기능 검증
    - _요구사항: 4.1, 4.2, 4.3, 4.4_

- [x] 8. 체크포인트 - 메뉴 타입별 기능 검증
  - 모든 테스트가 통과하는지 확인하고, 질문이 있으면 사용자에게 문의

- [x] 9. 메뉴 삭제 및 권한 관리 구현
  - [x] 9.1 메뉴 삭제 기능 구현
    - 확인 대화상자 및 삭제 프로세스
    - 데이터 아카이브 및 복구 시스템
    - _요구사항: 6.1, 6.2, 6.3_

  - [x] 9.2 권한 기반 메뉴 가시성 구현
    - 메뉴 접근 권한 확인
    - 동적 가시성 업데이트
    - _요구사항: 7.3_

  - [ ]* 9.3 메뉴 삭제 속성 테스트 작성
    - **속성 15: 메뉴 삭제 시 확인 대화상자 표시**
    - **속성 16: 메뉴 삭제 시 완전 제거**
    - **속성 17: 삭제된 메뉴 데이터 복구 기간 보관**
    - **검증: 요구사항 6.1, 6.2, 6.3**

- [x] 10. 오류 처리 및 복구 시스템 구현
  - [x] 10.1 네트워크 오류 처리
    - 연결 실패 시 재시도 로직
    - 오프라인 모드 지원
    - _요구사항: 7.5_

  - [x] 10.2 입력 검증 및 보안 강화
    - 악성 콘텐츠 검증
    - 사용자당 메뉴 수 제한
    - _요구사항: 8.1, 8.2_

  - [ ]* 10.3 오류 처리 속성 테스트 작성
    - **속성 19: 메뉴 삭제 실패 시 상태 유지 및 오류 설명**
    - **속성 23: 네비게이션 업데이트 실패 시 복구**
    - **속성 24: 사용자당 메뉴 수 제한**
    - **속성 25: 악성 콘텐츠 검증**
    - **검증: 요구사항 6.5, 7.5, 8.1, 8.2**

- [x] 11. 통합 및 최종 검증
  - [x] 11.1 전체 시스템 통합
    - 모든 컴포넌트 연결 및 데이터 흐름 확인
    - 기존 애플리케이션과의 호환성 검증
    - _요구사항: 모든 요구사항_

  - [ ]* 11.2 통합 테스트 작성
    - 엔드투엔드 플로우 테스트
    - 다중 사용자 시나리오 테스트
    - _요구사항: 모든 요구사항_

- [ ] 12. 최종 체크포인트 - 전체 시스템 검증
  - 모든 테스트가 통과하는지 확인하고, 질문이 있으면 사용자에게 문의

## 참고사항

- `*` 표시된 작업은 선택사항으로, 빠른 MVP를 위해 건너뛸 수 있습니다
- 각 작업은 특정 요구사항에 대한 추적성을 위해 요구사항을 참조합니다
- 체크포인트는 점진적 검증을 보장합니다
- 속성 테스트는 범용 정확성 속성을 검증합니다
- 단위 테스트는 특정 예제와 엣지 케이스를 검증합니다