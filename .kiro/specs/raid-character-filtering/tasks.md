# 구현 계획

- [x] 1. 캐릭터 필터링, 슬롯 검증 및 상태 직렬화를 위한 유틸리티 함수 생성
  - 순수 필터링 함수가 포함된 `src/features/raidSetup/filterUtils.ts` 생성
  - 캐릭터 필터링 로직을 위한 `filterAndSortCharacters` 함수 구현
  - 레이드 변경 시 슬롯 검증을 위한 `validateSlots` 함수 구현
  - 상태 저장을 위한 `serializeRaidSetupState` 및 `deserializeRaidSetupState` 함수 구현
  - 아이템 레벨 데이터 누락 처리 로직 추가
  - _요구사항: 2.1, 2.4, 2.5, 4.1, 4.2, 6.1, 6.2, 6.3_

- [x] 1.1 캐릭터 필터링을 위한 속성 테스트 작성
  - **속성 3: 캐릭터 필터링 정확성**
  - **검증: 요구사항 2.1**

- [x] 1.2 정렬 순서 유지를 위한 속성 테스트 작성
  - **속성 4: 정렬 순서 유지**
  - **검증: 요구사항 2.4**

- [x] 1.3 상태 직렬화 라운드트립을 위한 속성 테스트 작성
  - **속성 9: 상태 직렬화 라운드트립**
  - **검증: 요구사항 6.1, 6.2**

- [x] 2. 필터링 기능으로 RaidSlot 컴포넌트 향상
  - RaidSlot 컴포넌트에 `minItemLevel?: number` prop 추가
  - 유틸리티 함수를 사용하여 캐릭터 필터링 구현
  - 요구사항을 충족하는 캐릭터가 없을 때 플레이스홀더 메시지를 표시하도록 UI 업데이트
  - 모든 캐릭터가 필터링되는 엣지 케이스 처리
  - 아이템 레벨 데이터 누락 시 0으로 처리하는 로직 추가
  - _요구사항: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 2.1 동적 캐릭터 필터링을 위한 속성 테스트 작성
  - **속성 7: 동적 캐릭터 필터링**
  - **검증: 요구사항 5.1**

- [x] 3. RaidSetup 컴포넌트에 레이드 선택 UI 추가
  - 계정 검색 그리드 위에 레이드 선택 드롭다운 추가
  - `@/lib/raid-list`에서 `raidList` 가져오기 및 사용
  - 선택된 레이드 이름 및 최소 아이템 레벨 요구사항 표시
  - 제어 및 비제어 레이드 선택 모두 지원 (내부 상태 + props)
  - "레이드 선택 안함" 옵션 포함
  - 각 레이드 옵션에 최소 아이템 레벨 표시
  - _요구사항: 1.1, 1.2, 1.5, 3.1, 3.2, 3.4_

- [x] 3.1 레이드 선택 상태 저장을 위한 속성 테스트 작성
  - **속성 1: 레이드 선택 상태 저장**
  - **검증: 요구사항 1.2**

- [x] 4. 레이드 변경 시 슬롯 검증 구현
  - 레이드가 변경될 때 기존 슬롯 선택을 검증하는 로직 추가
  - 새로운 최소 아이템 레벨을 더 이상 충족하지 않는 슬롯 지우기
  - 새로운 요구사항을 여전히 충족하는 슬롯 유지
  - 모든 RaidSlot 컴포넌트에 `minItemLevel` prop 전달
  - "레이드 선택 안함"으로 변경 시 모든 선택 유지
  - _요구사항: 1.3, 4.1, 4.2, 4.3, 4.4_

- [x] 4.1 레이드 변경 시 필터링 업데이트를 위한 속성 테스트 작성
  - **속성 2: 레이드 변경 시 필터링 업데이트**
  - **검증: 요구사항 1.3**

- [x] 4.2 유효한 선택 유지를 위한 속성 테스트 작성
  - **속성 5: 유효한 선택 유지**
  - **검증: 요구사항 4.1**

- [x] 4.3 유효하지 않은 선택 지우기를 위한 속성 테스트 작성
  - **속성 6: 유효하지 않은 선택 지우기**
  - **검증: 요구사항 4.2**

- [x] 5. 계정 검색 후 슬롯 재검증 구현
  - 계정 검색 완료 시 기존 슬롯 선택을 재검증하는 로직 추가
  - 레이드가 선택되어 있을 때만 재검증 수행
  - 새로 로드된 캐릭터에 필터링 적용
  - _요구사항: 5.1, 5.2, 5.4_

- [x] 5.1 슬롯 재검증을 위한 속성 테스트 작성
  - **속성 8: 슬롯 재검증**
  - **검증: 요구사항 5.4**

- [x] 6. 오류 처리 및 엣지 케이스 추가
  - 누락되거나 유효하지 않은 ItemLevel 데이터를 우아하게 처리
  - 유효하지 않은 레이드 선택 처리 (레이드 선택 안함으로 처리)
  - 직렬화/역직렬화 오류 처리
  - 손상된 상태 데이터 복원 실패 처리
  - 엣지 케이스 디버깅을 위한 콘솔 경고 추가
  - 빈 캐릭터 목록 및 레이드 선택 안함 시나리오 테스트
  - _요구사항: 1.4, 2.3, 2.5, 5.3, 6.3_

- [x] 7. SchedulePage와 통합
  - 레이드 선택 상태를 관리하도록 SchedulePage 업데이트
  - RaidSetup에 `selectedRaid` 및 `onRaidChange` props 전달
  - 상태 직렬화/역직렬화를 사용한 상태 저장 및 복원 구현
  - 기존 아이템 레벨 검증 로직이 새로운 필터링과 함께 작동하는지 확인
  - 스케줄 페이지 컨텍스트에서 기능이 엔드투엔드로 작동하는지 테스트
  - _요구사항: 5.1, 5.2, 6.1, 6.2_

- [x] 8. 체크포인트 - 모든 테스트 통과 확인
  - 모든 테스트가 통과하는지 확인하고, 질문이 있으면 사용자에게 문의합니다.
